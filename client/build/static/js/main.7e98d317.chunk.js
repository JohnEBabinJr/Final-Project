(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{20:function(e,t,a){},32:function(e,t,a){e.exports=a.p+"static/media/spotify-icon.daf13776.png"},35:function(e,t,a){e.exports=a(75)},40:function(e,t,a){},41:function(e,t,a){},42:function(e,t,a){},75:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(11),s=a.n(r),l=(a(40),a(8)),c=a(3),i=a(7),m=a(5),u=a(4),p=a(6),h=a(1),d=a(16),f=(a(41),window.location.hash.substring(1).split("&").reduce(function(e,t){if(t){var a=t.split("=");e[a[0]]=decodeURIComponent(a[1])}return e},{}));window.location.hash="";var k=f,y=a(32),b=a.n(y),g=(a(42),a(17)),v=a.n(g),E=a(33),N=(a(45),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).state={token:a.props.token,deviceId:"",error:"",loggedIn:!1,trackName:"Track Name",artistName:"Artist Name",albumName:"Album Name",nickname:"Nickname",playing:!1,position:0,duration:0},a.playerCheckInterval=null,a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleLogin",value:function(){var e=this;console.log(this.props),this.setState({token:this.props.token}),""!==this.state.token&&this.setState({loggedIn:!0}),this.playerCheckInterval=setInterval(function(){return e.checkForPlayer()},1e3)}},{key:"checkForPlayer",value:function(){var e=this.state.token;null!==window.Spotify&&(clearInterval(this.playerCheckInterval),this.player=new window.Spotify.Player({name:"Spotify Player",getOAuthToken:function(t){t(e)}}),this.createEventHandlers(),this.player.connect())}},{key:"onStateChanged",value:function(e){if(null!==e){var t=e.track_window,a=t.current_track,n=t.position,o=t.duration,r=a.name,s=a.album.name,l=a.artists.map(function(e){return e.name}).join(", "),c=!e.paused;this.setState({position:n,duration:o,trackName:r,albumName:s,artistName:l,playing:c})}}},{key:"createEventHandlers",value:function(){var e=this;this.player.on("initialization_error",function(e){console.error(e)}),this.player.on("authentication_error",function(t){console.error(t),e.setState({loggedIn:!1})}),this.player.on("account_error",function(e){console.error(e)}),this.player.on("playback_error",function(e){console.error(e)}),this.player.on("player_state_changed",function(t){return e.onStateChanged(t)}),this.player.on("ready",function(){var t=Object(E.a)(v.a.mark(function t(a){var n;return v.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.device_id,console.log("Let the music play on!"),t.next=4,e.setState({deviceId:n});case 4:e.transferPlaybackHere();case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())}},{key:"transferPlaybackHere",value:function(){var e=this.state,t=e.deviceId,a=e.token;fetch("https://api.spotify.com/v1/me/player",{method:"PUT",headers:{authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({device_ids:[t],play:!0})})}},{key:"onPrevClick",value:function(){this.player.previousTrack()}},{key:"onPlayClick",value:function(){this.player.togglePlay()}},{key:"onNextClick",value:function(){this.player.nextTrack()}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.state,a=(t.token,t.loggedIn,t.artistName),n=t.trackName,r=t.albumName,s=(t.error,t.position),l=(t.duration,t.playing),c=t.nickname;return o.a.createElement("div",{className:"Player"},o.a.createElement("p",null,o.a.createElement("button",{class:"btn-circle",onClick:function(){return e.onPrevClick()}},o.a.createElement("i",{class:"fas fa-step-backward"})),o.a.createElement("button",{onClick:function(){return e.onPlayClick()}},l?o.a.createElement("i",{class:"fas fa-pause"}):o.a.createElement("i",{class:"fas fa-play"})),o.a.createElement("button",{onClick:function(){return e.onNextClick()}}," ",o.a.createElement("i",{class:"fas fa-step-forward"})," ")),o.a.createElement("div",null,o.a.createElement("table",{class:"table table-bordered bg-white",id:"playlistTable"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",{scope:"col"},"#"),o.a.createElement("th",{scope:"col"},"Song"),o.a.createElement("th",{scope:"col"},"Artist"),o.a.createElement("th",{scope:"col"},"Album"),o.a.createElement("th",{scope:"col"},"Added"))),o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("th",{scope:"row"},s),o.a.createElement("td",null,n),o.a.createElement("td",null,a),o.a.createElement("td",null,r),o.a.createElement("td",null,c))))))}}]),t}(o.a.Component)),O=function(e){return o.a.createElement("div",null,e.children)},C=(a(20),a(12)),S=a.n(C),A=a(9);a(23).config();var I=["user-top-read","user-read-email","user-read-private","user-read-currently-playing","user-read-playback-state","streaming","user-modify-playback-state","app-remote-control","playlist-modify-public"],j=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).handleInputChange=function(e){var t=e.target,n=t.name,o=t.value;a.setState(Object(l.a)({},n,o))},a.handleFormSubmit=function(e){},a.state={nickname:"",modalIsOpen:!1},a.openModal=a.openModal.bind(Object(h.a)(Object(h.a)(a))),a.afterOpenModal=a.afterOpenModal.bind(Object(h.a)(Object(h.a)(a))),a.closeModal=a.closeModal.bind(Object(h.a)(Object(h.a)(a))),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"openModal",value:function(){this.setState({modalIsOpen:!0})}},{key:"afterOpenModal",value:function(){}},{key:"closeModal",value:function(){this.setState({modalIsOpen:!1})}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(A.a,{className:"userButton",onClick:this.openModal},"New Room"),o.a.createElement(S.a,{isOpen:this.state.modalIsOpen,onAfterOpen:this.afterOpenModal,onRequestClose:this.closeModal,className:"Modal",overlayClassName:"Overlay",contentLabel:"Example Modal"},o.a.createElement(A.a,{id:"close",onClick:this.closeModal},o.a.createElement("i",{class:"fas fa-window-close"})),o.a.createElement("div",{className:"content"},o.a.createElement("p",null,"Let's get started with a new playlist. Enter a nickname for yourself."),this.props.children)))}}]),t}(o.a.Component);a(23).config();var w=["user-top-read","user-read-currently-playing","user-read-playback-state","playlist-modify-public"],M=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).handleInputChange=function(e){var t=e.target,n=t.name,o=t.value;a.setState(Object(l.a)({},n,o))},a.handleFormSubmit=function(e){e.preventDefault(),a.getSong(a.state.token)},a.state={roomId:"",nickname:"",modalIsOpen:!1},a.openModal=a.openModal.bind(Object(h.a)(Object(h.a)(a))),a.afterOpenModal=a.afterOpenModal.bind(Object(h.a)(Object(h.a)(a))),a.closeModal=a.closeModal.bind(Object(h.a)(Object(h.a)(a))),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"openModal",value:function(){this.setState({modalIsOpen:!0})}},{key:"afterOpenModal",value:function(){}},{key:"closeModal",value:function(){this.setState({modalIsOpen:!1})}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(A.a,{onClick:this.openModal},"Join Room"),o.a.createElement(S.a,{isOpen:this.state.modalIsOpen,onAfterOpen:this.afterOpenModal,onRequestClose:this.closeModal,className:"Modal",overlayClassName:"Overlay",contentLabel:"Example Modal"},o.a.createElement(A.a,{id:"close",onClick:this.closeModal},o.a.createElement("i",{class:"fas fa-window-close"})),o.a.createElement("div",{className:"content"},o.a.createElement("p",null,"Let's get you started. Enter a nickname for yourself."),this.props.children)))}}]),t}(o.a.Component),T=a(10),_=a.n(T),x={getTracks:function(){return _.a.get("/api/tracks")},getTracksById:function(e){return _.a.get("/api/tracks/"+e)},getTracksByRoomId:function(e){return _.a.get("/api/tracks/"+e)},deleteTracks:function(e){return _.a.delete("/api/tracks/"+e)},saveTrack:function(e){return _.a.post("/api/tracks",e)}},P=(a(74),n.Component,function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(m.a)(this,Object(u.a)(t).call(this))).makeRoom=function(){var t,a=sessionStorage.getItem("nickname");if(sessionStorage.getItem("room"))return t=sessionStorage.getItem("room"),e.setState({room:t,nickname:a}),sessionStorage.removeItem("room"),e.state.room;t="";for(var n=[],o=0;o<4;o++)n.push(Math.floor(Math.random()*Math.floor(10)));return t=n.join(""),console.log(t),e.setState({room:t,nickname:a}),sessionStorage.removeItem("room"),e.state.room},e.getStuffFromDB=function(){x.getTracksByRoomId(e.state.room).then(function(t){e.setState({songArray:t.data}),console.log(e.state.songArray)})},e.handleInputChange=function(t){var a=t.target,n=a.name,o=a.value;e.setState(Object(l.a)({},n,o))},e.handleFormSubmit=function(t){t.preventDefault(),e.getSong(e.state.token)},e.handleModalSubmit=function(){sessionStorage.setItem("nickname",e.state.nickname),e.state.room&&sessionStorage.setItem("room",e.state.room),e.ChangeColorFunction()},e.state={nickname:"",songArray:[],room:"",username:"",tempTrack:"",tempArtist:"",tempAlbum:"",token:"",item:{album:{images:[{url:""}]},name:"",artists:[{name:""}],duration_ms:0},is_playing:"Paused",nextToPlay:"",progress_ms:0},e.getCurrentlyPlaying=e.getCurrentlyPlaying.bind(Object(h.a)(Object(h.a)(e))),e}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=k.access_token;e&&(this.setState({token:e}),this.makeRoom(),setTimeout(this.getStuffFromDB,500))}},{key:"getCurrentlyPlaying",value:function(e){var t=this;d.ajax({url:"https://api.spotify.com/v1/me/player",type:"GET",beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+e)},success:function(e){console.log("data",e),t.setState({item:e.item,is_playing:e.is_playing,progress_ms:e.progress_ms})}})}},{key:"getSong",value:function(e){var t=this,a="";this.state.tempTrack&&this.state.tempArtist&&this.state.tempAlbum?a="https://api.spotify.com/v1/search?q=".concat(this.state.tempTrack,"&type=track&artist=").concat(this.state.tempArtist,"&album=").concat(this.state.tempAlbum,"&offset=0&limit=1"):this.state.tempTrack&&this.state.tempArtist&&!this.state.tempAlbum?a="https://api.spotify.com/v1/search?q=".concat(this.state.tempTrack,"&type=track&artist=").concat(this.state.tempArtist,"&offset=0&limit=1"):this.state.tempTrack&&!this.state.tempArtist&&this.state.tempAlbum?a="https://api.spotify.com/v1/search?q=".concat(this.state.tempTrack,"&type=track&album=").concat(this.state.tempAlbum,"&offset=0&limit=1"):!this.state.tempTrack&&this.state.tempArtist&&this.state.tempAlbum?a="https://api.spotify.com/v1/search?type=track&artist=".concat(this.state.tempArtist,"&album=").concat(this.state.tempAlbum,"&offset=0&limit=1"):!this.state.tempTrack||this.state.tempArtist||this.state.tempAlbum?this.state.tempTrack||!this.state.tempArtist||this.state.tempAlbum?this.state.tempTrack||this.state.tempArtist||!this.state.tempAlbum?alert("Must enter at least one value!"):a="https://api.spotify.com/v1/search?type=track&album=".concat(this.state.tempAlbum,"&offset=0&limit=1"):a="https://api.spotify.com/v1/search?type=track&artist=".concat(this.state.tempArtist,"&offset=0&limit=1"):a="https://api.spotify.com/v1/search?q=".concat(this.state.tempTrack,"&type=track&offset=0&limit=1"),d.ajax({url:a,type:"GET",beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+e)},success:function(e){console.log("data",e);var a=sessionStorage.getItem("nickname");x.saveTrack({roomId:t.state.room,trackId:e.tracks.items[0].id,trackName:e.tracks.items[0].name,artistName:e.tracks.items[0].artists[0].name,albumName:e.tracks.items[0].album.name,albumCover:e.tracks.items[0].album.images[1].url,userName:a}),console.log(t.state.nickname)}}).then(setTimeout(this.getStuffFromDB,1e3))}},{key:"setSong",value:function(){alert("Hello!")}},{key:"setCurrentPlayingSong",value:function(e){alert(e)}},{key:"handleTrack",value:function(e){console.log("handletrack"),x.saveTrack({roomId:this.makeRoom(),trackId:e.tracks.items[0].id,trackName:e.tracks.items[0].name,artistName:e.tracks.items[0].artists[0].name,albumName:e.tracks.items[0].album.name,albumCover:e.tracks.items[0].album.images[1].url,userName:this.state.nickname}).then(function(e){return console.log("result:"+e)})}},{key:"render",value:function(){var e=this,t=o.a.createElement("a",{href:"https://github.com/JohnEBabinJr/final-project/",className:"mr-1"},o.a.createElement("i",{className:"fab fa-github fa-1x"})),a=o.a.createElement("a",{href:"/about",className:"ml-2"},"About Us"),n=o.a.createElement("a",{href:"/"},o.a.createElement("i",{className:"fas fa-home"})),r=o.a.createElement("a",{href:"https://jon-finder.herokuapp.com/"},o.a.createElement("i",{class:"fas fa-toilet"}));return o.a.createElement("div",{className:"App"},o.a.createElement("div",{className:"home"},o.a.createElement("a",{style:{float:"left",marginLeft:"10px"}},n)),o.a.createElement("div",{className:"links"},t," | ",r," | ",a," |"),o.a.createElement("header",{className:"App-header"},this.state.token&&o.a.createElement("div",null,o.a.createElement("div",{class:"container"},o.a.createElement("div",{class:"row"},o.a.createElement("div",{class:"col"},o.a.createElement("div",{className:"Player-header"},o.a.createElement("h2",null,"Now Playing"),o.a.createElement("p",null,"Let's get this party started, ",this.state.username,"! Your room number is:",o.a.createElement("br",null),o.a.createElement("span",{className:"roomID"},this.state.room)),o.a.createElement("hr",{class:"my-4",id:"spacer"})),o.a.createElement("form",null,o.a.createElement("input",{type:"text",placeholder:"Track",name:"tempTrack",value:this.state.tempTrack,onChange:this.handleInputChange}),o.a.createElement("input",{type:"text",placeholder:"Artist",name:"tempArtist",value:this.state.tempArtist,onChange:this.handleInputChange}),o.a.createElement("input",{type:"text",placeholder:"Album",name:"tempAlbum",value:this.state.tempAlbum,onChange:this.handleInputChange}),o.a.createElement("button",{onClick:this.handleFormSubmit},"Submit")))))),!this.state.token&&o.a.createElement("div",{className:"container"},o.a.createElement("img",{src:b.a,className:"App-logo",alt:"logo"}),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col col-5 mx-auto",id:"app"},o.a.createElement("h1",null,"Car - ",o.a.createElement("i",{class:"fas fa-road"})," - OK"),o.a.createElement("p",{className:"lead mx-3"},"Collaborate on the ultimate roadtrip playlist with your friends using Spotify. Share the link, queue up songs, and export your playlist to relive the memories.")))),o.a.createElement("div",{className:"container",id:"buttonContainer"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col"}," ",!this.state.token&&o.a.createElement(j,null," ",o.a.createElement("form",null,o.a.createElement("input",{type:"text",placeholder:"Nickname",name:"nickname",value:this.state.nickname,onChange:this.handleInputChange}),o.a.createElement("a",{id:"goButton",className:"btn btn--loginApp-link",href:"".concat("https://accounts.spotify.com/authorize","?client_id=").concat("749b6ea423c24fef905f41108b8c3a3f","&redirect_uri=").concat("https://car-a-ok.herokuapp.com/","&scope=").concat(I.join("%20"),"&response_type=token&show_dialog=true"),onClick:this.handleModalSubmit},"Go")))),o.a.createElement("div",{className:"col"}," ",!this.state.token&&o.a.createElement(M,null," ",o.a.createElement("form",{className:"form-inline"},o.a.createElement("div",{className:"form-group mb-2"},o.a.createElement("label",{for:"nickname",className:"sr-only"},"nickname"),o.a.createElement("input",{type:"text",className:"form-control-plaintext",name:"nickname",placeholder:"Nickname",value:this.state.nickname,onChange:this.handleInputChange}),o.a.createElement("input",{type:"text",className:"form-control-plaintext",placeholder:"Room ID",name:"room",value:this.state.room,onChange:this.handleInputChange}),o.a.createElement("a",{className:"btn btn--loginApp-link",href:"".concat("https://accounts.spotify.com/authorize","?client_id=").concat("749b6ea423c24fef905f41108b8c3a3f","&redirect_uri=").concat("http://localhost:3000/","&scope=").concat(w.join("%20"),"&response_type=token&show_dialog=true"),onClick:this.handleModalSubmit}))))))),this.state.token&&o.a.createElement(O,null,this.state.songArray.map(function(t){return o.a.createElement("div",null,o.a.createElement("tr",null,o.a.createElement("td",null,t.trackName),o.a.createElement("td",null,t.artistName),o.a.createElement("td",null,t.albumName),o.a.createElement("td",null,t.userName),o.a.createElement("td",null,o.a.createElement("button",{onClick:function(){return e.setCurrentPlayingSong(t.trackId)}},"Nice"))))})),o.a.createElement(N,{token:this.state.token,nickname:this.state.nickname})))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));console.log("made it here"),s.a.render(o.a.createElement(P,null),document.getElementById("root")),console.log("should be calling app"),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[35,1,2]]]);
//# sourceMappingURL=main.7e98d317.chunk.js.map